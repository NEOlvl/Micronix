<!DOCTYPE html>
        <html lang="en">
        <head>
        <meta charset="UTF-8">
        <title>FERRO / Бином</title>
    <link rel="icon" href="icon.png" type="image/x-icon" sizes="any">
    <link href="index-ver2.0.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-latest.js" type="text/javascript"></script>
    <script src="js/jquery.min.js" type="text/javascript"></script>
    <script src="js/jquery-ui.min.js" type="text/javascript"></script>
    <script src="js/jquery.ui.touch-punch.min.js"></script>
    <script type="text/javascript" src="/eel.js"></script>
    <!--<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="viewport" content="width=device-width, user-scalable=no">-->
    <style>
        :root {
            /* --repas-avatar-user: url('https://sun7-6.userapi.com/s/v1/ig1/iXIW1GFx_o9s2w2leVOChd6-lfIiMI8OobK4UW1PVBsbx-TQKvfVdinF8z00p95s2g0OHrqm.jpg?size=50x50&quality=96&crop=645,5,1167,1167&ava=1');*/
            --repas-user-background: #cbd5d6;
            --repas-avatar-user: url('img/avatars/peeps-avatar-alpha (1).png') center/110% no-repeat, linear-gradient(to top, var(--repas-user-background), var(--repas-user-background));
        }
    </style>
</head>
<body class="_body">
<div class="_body_load_construct">
    <div class="_block_menu_body_construct">
        <div class="_block_head_menu_construct_block">
            <!-- <div class="_block_logo_admin_panel_content">
                 <div class="_block_logo_admin_panel"></div>
             </div>-->
            <a href="">
                <div class="_link_item_menu_construct">
                    <div class="_icon_item_link_menu_cont">
                        <div class="_icon_item_link_menu">
                            <span class="_icon_svg_menu_block _icon_menu_menu"></span>
                        </div>
                    </div>
                    <div class="_name_link_item_content">FERRO</div>
                </div>
            </a>
        </div>
        <div class="_content_block_menu">
            <a href="">
                <div class="_link_item_menu_construct">
                    <div class="_icon_item_link_menu_cont">
                        <div class="_icon_item_link_menu">
                            <span class="_icon_svg_menu_block _icon_menu_home"></span>
                        </div>
                    </div>
                    <div class="_name_link_item_content">Главная</div>
                </div>
            </a>
            <a href="staff.html">
                <div class="_link_item_menu_construct">
                    <div class="_icon_item_link_menu_cont">
                        <div class="_icon_item_link_menu">
                            <span class="_icon_svg_menu_block _icon_menu_measurement"></span>
                        </div>
                    </div>
                    <div class="_name_link_item_content">Измерения</div>
                </div>
            </a>
            <a href="">
                <div class="_link_item_menu_construct">
                    <div class="_icon_item_link_menu_cont">
                        <div class="_icon_item_link_menu">
                            <span class="_icon_svg_menu_block _icon_menu_documents"></span>
                        </div>
                    </div>
                    <div class="_name_link_item_content">Отчёты</div>
                </div>
            </a>
        </div>
        <div class="_block_footer_menu_content">
            <a class="_notification_card" style="opacity: 0.5">
                <div class="_link_item_menu_construct">
                    <div class="_icon_item_link_menu_cont">
                        <div class="_icon_item_link_menu _cloud_link_item_menu">
                            <span class="_icon_svg_menu_block _icon_menu_cloud"></span>
                        </div>
                    </div>
                    <div class="_name_link_item_content">Синхронизация</div>
                </div>
            </a>
            <a href="">
                <div class="_link_item_menu_construct">
                    <div class="_icon_item_link_menu_cont">
                        <div class="_icon_item_link_menu">
                            <span class="_icon_svg_menu_block _icon_menu_setting"></span>
                        </div>
                    </div>
                    <div class="_name_link_item_content">Настройки</div>
                </div>
            </a>
            <a class="_setting_account_card">
                <div class="_link_item_menu_construct">
                    <div class="_icon_item_link_menu_cont">
                        <div class="_icon_item_link_menu">
                            <span class="_icon_svg_menu_block _icon_menu_account"></span>
                        </div>
                    </div>
                    <div class="_name_link_item_content">Гость</div>
                </div>
            </a>
        </div>
    </div>
    <div class="_setting_account_block_content">
        <div class="_block_account_card_info">
            <div class="_block_card_head_info">
                <span class="_icon_svg_menu_block _icon_menu_account _icon_account_set_card"></span>
                <div class="_info_acc_card_setting">
                    <div class="_name_card_info_set_account">Гость</div>
                    <div class="_descript_card_info_set_account">Общий доступ</div>
                </div>
            </div>
            <div class="_block_card_head_info _block_actions_account_menu">
                <span class="_logout_card_card_info" title="Выйти из аккаунта"></span>
            </div>
        </div>
    </div>
    <div class="_block_main_content">
        <div class="_head_block_main_body_content">
            <div class="_content_block_info_head_main_body _block_address_desktop_device">
                <div class="_box_content_info_head">
                    <div class="_name_organisation_repas_head_block">Бином</div>
                    <span class="_system_block_wty">/</span>
                    <div class="_name_page_title_main_block">Измерения</div>
                </div>
            </div>
        </div>
        <div class="_block_title_info">
            <div class="_title_main_page">Измерение #t7UWN</div>
            <div class="_subtitle_block_ferro">
                <div class="_block_info_about_measure">
                    <div class="_block_about_info_measure">CABAN R180</div>
                    <div class="_block_about_info_measure">RESONATOR 4</div>
                    <div class="_block_about_info_measure">19.11.2024 17:56:46</div>
                </div>
                <div class="_block_info_about_measure _button_block_action_page_data">
                    <button class="_button_link_grey _icon_button _icon_setting">Настройки</button>
                    <button class="_button_link_grey _icon_button _icon_add _open_sorting_block">Скачать</button>
                    <div class="_block_sorting_fields_window" style="display: none;">
                        <a href="" id="DownloadPNG">
                            <div class="_link_sorting_block_content">
                                <div class="_name_sort_item">Изображение (png)</div>
                            </div>
                        </a>
                        <div class="_link_sorting_block_content">
                            <div class="_name_sort_item">Исходный файл (сsv)</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="_graph_create">
                <div class="_graph_create_block">
                    <canvas id="myChart"></canvas>
                </div>
                <div class="_info_about_graph">
                    <div class="_block_info_data_meas">
                        <div>
                            <div class="_title_for_measure_info">
                                <div class="_marker_title_info_mes"></div>
                                <div class="_subtitle_for_mes_info">Без образца</div>
                            </div>
                            <div class="_block_about_info_measure">Точка min <span class="_FF">(F₀)</span>  <br>76 ГГц <br>   -30 ДцБ</div>
                            <div class="_block_about_info_measure">Добротность <span class="_FF">(Q)</span> <br> 789</div>
                            <div class="_title_for_measure_info _mr_top20">
                                <div class="_marker_title_info_mes _marker_yellow"></div>
                                <div class="_subtitle_for_mes_info">С образцом</div>
                            </div>
                            <div class="_block_about_info_measure">Точка min <span class="_FF">(F₀)</span>  <br>76 ГГц <br>   -30 ДцБ</div>
                            <div class="_block_about_info_measure">Добротность <span class="_FF">(Q)</span> <br> 789</div>
                        </div>
                        <div class="_mr_top30">
                            <div class="_block_about_info_measure">Привязанное вычисление</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

        <div class="_download_window" id="_download_window">

        </div>
        <script>
            var Obj = new Object();
            async function run() {
                  let x_graph = await eel.graph_x()();
                  var x_gr = x_graph.split(',').map(Number);
                  let y_graph = await eel.graph_y()();
                  var y_gr = y_graph.split(',').map(Number);
                  let y_graph2 = await eel.graph_y2()();
                  var y_gr2 = y_graph2.split(',').map(Number);
                  const array_all = [x_gr, y_gr, y_gr2];
                  return array_all;
            };
            console.log(Obj.y_gr);
            run().then(response => {
                Obj.x_gr = response[0];
                Obj.y_gr = response[1];
                Obj.y_gr2 = response[2];

                const ctx = document.getElementById('myChart');

                let pieChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: Obj.x_gr,
                        datasets: [{
                            label: 'Без образца',
                            data: Obj.y_gr,
                            borderWidth: 2,
                            pointStyle: false,
                            borderColor: '#7879F1',
                        },
                        {
                            label: 'С образцом',
                            data: Obj.y_gr2,
                            borderWidth: 2,
                            pointStyle: false,
                            borderColor: '#f8c33c',
                        }]
                    },
                    options: {
                        maintainAspectRatio: false, /* соблюдение пропорций */

                        responsive: true,
                        hover: {
                            mode: 'index',
                            intersec: false
                        },
                        plugins: {
                            customCanvasBackgroundColor: {
                                color: 'white',
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false
                            },
                        },
                        scales: {
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Частота, Гц'
                                    },
                                    ticks: {
                                        source: 'auto',
                                        // Disabled rotation for performance
                                        maxRotation: 0,
                                        autoSkip: true,
                                    }
                                },
                                y: {
                                    title: {
                                        display: true,
                                        text: 'ДцБ'
                                    },
                                    beginAtZero: true
                                }
                        }
                    }
                });
                setInterval(function(){
                    async function run2() {
                          let y_graph = await eel.graph_y()();
                          var y_gr = y_graph.split(',').map(Number/1000000000);
                          pieChart.data.datasets[0].data = y_gr;
                          pieChart.update();
                          console.log("Update - ok");
                    };
                    run2();
                }, 500);


                const getRandomValue = () => {
                    return Math.floor(Math.random() * 100)
                }
            });


        </script>
        <script>
            function fillCanvasBackgroundWithColor(canvas, color) {
                const context = canvas.getContext('2d');
                context.save();
                context.globalCompositeOperation = 'destination-over';
                context.fillStyle = color;
                context.fillRect(0, 0, canvas.width, canvas.height);
                context.restore();
            }


            $('._open_sorting_block').click(function(){
                $('._block_sorting_fields_window').toggle();
                const canvas = document.getElementById('myChart');

                
                fillCanvasBackgroundWithColor(canvas, 'white');

                var dataURL = canvas.toDataURL("image/png", 1);
                console.log(dataURL);
                /*const link = document.createElement('a');
                link.href = dataURL;
                link.text = 'HDow';
                link.download = 'ui7tb.png';
                document.getElementById('_download_window').appendChild(link);*/
                document.getElementById('DownloadPNG').setAttribute('href', dataURL);
                document.getElementById('DownloadPNG').setAttribute('download', 'ui7tb.png');
            });
            if(!$(event.target).closest("._open_sorting_block").length){
                if(!$(event.target).closest("._block_sorting_fields_window").length){
                    $('._block_sorting_fields_window').hide();
                }
            }
        </script>
        <script>
        </script>
    </div>
</div>
</body>


</html>

</body>
</html>